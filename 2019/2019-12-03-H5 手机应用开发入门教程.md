# H5 手机 App 开发入门

手机现在是互联网的主要入口。根据[《中国互联网报告》](https://www.ifanr.com/1254954)，中国手机网民已经超过8亿，人均每天上网三个多小时。

毫不奇怪，手机应用软件（mobile application，简称 mobile App）的开发工程师供不应求，一直是 IT 招聘的热门岗位。

如果进入这个行业，你一定会听到很多人谈论“H5 开发”。这是目前 App 开发的主流技术之一，开发周期短、成本低、兼容传统的 Web 开发。但是，很少有文章详细介绍，到底什么是 H5 开发，原理是什么，它跟其他技术的差异在哪里。

本文就来谈谈这个主题，今天是第一篇，介绍一些基本概念。内容尽量通俗，不过本来也没有太复杂的东西。我希望，这篇文章既可以帮助新手入门，也可以供熟练开发者回顾和整理知识点。

## 一、H5 的含义

手机 App 就是手机系统的应用程序。按照开发技术，可以分成三大类。

> - 原生应用（native application，简称 native App）
> - Web 应用（web application，简称 Web App）
> - 混合应用（hybrid application，简称 hybrid App）

这三类 App 的技术模型都不一样，各有优缺点。公司一般会选择其中一种作为主要技术栈，构建自己的手机 App。

它们不是同时出现的，有一个发展过程。

原生 App 最早出现，跟智能手机系统一起诞生。2007年6月 iPhone 发布，2008年9月安卓发布，就同时发布了自己平台的应用程序开发方法。

然后是 Web App 的出现。2008年，w3c 组织发布了网页语言 HTML 的第5版，简称 HTML 5。这个版本大大增强了网页的功能，网页可以替代一部分原生应用的功能。这就是 Web App 的由来。

混合 App 最晚出现，是原生 App与 Web App的结合，相当于原生 App 里面放入 Web 网页。原生 App 作为一个壳，里面放入 HTML5 网页的手机 App，这种开发模型就简称为 H5。

因为 App 的“壳”通常都是现成的，或者有现成的工具打包成“壳”，所以 H5 开发一般是指，使用传统编写网页的方法，编写手机 App 的页面，即壳里面的内容，不包括壳本身。H5 这个词是国内独有的，前端程序员用得比较多，国外就称为“混合 App”。

下面就详细介绍这三种技术模型，及其特点。

## 二、原生应用

### 2.1 概念

原生 App 是专门为特定手机平台开发的应用程序，无法在其他平台运行。因此，一个程序如果同时支持苹果的 iOS 和谷歌的安卓，就需要为它们各写一个原生 App。

原生 App 使用与手机操作系统相同的语言编写。iOS 的原生 App 使用 Objective-C 语言或 Swift 语言，安卓使用 Java 语言或 Kotlin 语言。由于跟底层系统的语言和技术模型一致，所以原生 App 的性能和用户体验都很好。

### 2.2 优点和缺点

除了性能，原生 App 的最大优点是，可以使用系统的所有硬件和软件 API，比如 GPS、摄像头、麦克风、加速计、通知推送等等，因此能充分发挥系统的潜力。

原生 App 的缺点主要是成本，就像上面说的，必须为每个平台都建立一个开发团队。大公司现在都有两个手机 App 开发团队，一个安卓，一个 iOS，如果将来出现第三个平台（以前的 Windows Phone，或者将来可能的华为鸿蒙 OS），再组建第三个团队，成本就更高。

其他的缺点还有，原生 App 使用的是底层系统的语言，都是很重的编译型语言，难度相对较高，开发速度较慢，这也会导致成本上升。另外，原生 App 必须下载安装后才能使用，如果升级版本，用户就必须重新下载安装一次。这对用户和厂商都很麻烦，用户往往不愿意更新版本，厂商不得不被迫长期维护多年前的旧版本。

## 三、Web 应用

### 3.1 概念

Web App 是网页写成的应用程序，必须在浏览器中使用。比如，收发电子邮件，可以下载原生 App 的客户端，也可以使用浏览器登录网站，后者就是 Web App。

Web App 主要使用网页技术，即 HTML、JavaScript 和 CSS。它的最大优点是不需要下载安装，用户打开浏览器就能使用，而且总是在使用 App 的最新版本。

但是，网页提供的 API（即 Web API）很有限，目前只有相机、GPS、电池等少数几项，大部分硬件都不能通过网页访问，浏览器也无法直接读取硬盘文件，所以 Web App 无法利用平台的硬件。

另外，网页通过浏览器渲染，性能不如原生 App 页面的底层系统直接渲染。所以，Web App 不适合做性能要求较高的页面。

### 3.2 Web App 与 原生 App 的比较

对于开发者来说，Web App 写起来比较快，调试容易，不需要应用商店的批准就能发布。但是，它需要打开浏览器才能使用，这意味着，用户必须记住如何导航到它，要么直接输入网址，要么翻找书签菜单。很少有人知道，可以把 Web 书签当作图标放在主屏幕上。这导致进入 Web App，远不如原生 App 方便。事实证明，这是致命缺点。许多调查都显示，用户偏好使用原生 App。

谷歌曾经调查了1000个原生 App 和1000个 Web App，发现 Web App 的用户覆盖数量（1100万）多于原生 App（400万），但是原生 App 的用户使用时间（188分钟）远超 Web App（9分钟）。

![](https://www.wangbase.com/blogimg/asset/201912/bg2019120307.jpg)

![](https://www.wangbase.com/blogimg/asset/201912/bg2019120308.jpg)

另一项调查发现，用户把87％的时间用在原生 App，只有13％的时间用在访问网站。由于这个原因，企业很少使用 Web App，都是把原生 App 当作首选。

但是，Web App 也不是毫无竞争力。我们知道，用户的大部分时间花费在少数几个App 上面，根据调查，普通用户每月平均使用27个原生 App，但访问了100多个手机网站。

这意味着，小公司的 App 使用频率非常低，而且获客成本极高，企业不得不花费大量资金，吸引用户安装自己的 App，好不容易装上了，效果也不好，最终都变成僵尸 App。这种情况下，小公司开发 Web App 更合适，不仅成本低，而且可以服务更多的用户，以及更好地宣传自己（可以被搜索引擎索引）。

### 3.3 PWA

谷歌公司的 Chrome 浏览器团队认为，Web App 足以满足大多数 App 的需求，但是三大缺陷阻碍它的推广。

> 1. 不能从手机的首屏直接进入。
> 2. 缺乏手机状态栏和锁屏的通知推送能力。
> 3. 不支持脱机访问（即断网时的使用）。

为了解决这些问题，Chrome 团队开发了“渐进式 Web App”（Progressive Web App，缩写 PWA）。它可以把网站缓存在手机里面，供离线时使用，还能在手机首屏生成图标，直接点击进入，并且有通知推送能力，使用时也不带浏览器的地址栏和状态栏，总之跟原生 App 的使用体验非常接近。

但是，PWA 需要在浏览器访问一次网站，才能在首屏生成图标，并且 iOS 系统的支持还不够理想。所以，目前为止 PWA 还是缺乏足够的成功案例。

## 四、混合应用

### 4.1 概念

混合 App 顾名思义就是原生 App 与 Web App 的一种结合。它的壳是原生 App，依然需要下载安装，但是里面的页面是网页，而不是用原生控件做的。可以理解成，混合 App 里面隐藏了一个浏览器，用户看到的实际上是这个隐藏浏览器渲染出来的网页。

![](https://www.wangbase.com/blogimg/asset/201912/bg2019120404.jpg)

混合 App 的外壳，通常称为“容器”。内部隐藏的浏览器，可以由容器自己实现，也可以是系统提供的网页渲染控件，即 WebView 控件。因此，混合 App 在结构上分成三层：HTML5 网页层、网页引擎层（本质上是一个隔离的浏览器实例）、容器层。

由于页面需要通过中间层跟底层系统通信，所以混合 App 的性能也不如原生 App。

### 4.2 API Bridge

混合 App 里面的网页，可以使用底层系统的所有 API。奥秘就在于容器提供了 API Bridge，即提供了底层 API 的中介，允许内部的网页调用。

开发者想要使用哪一个 API，就通过 API Bridge 向容器发请求，容器接到请求，再调用底层系统的 API。容器的 API Bridge 往往用 JavaScript 语言提供，这时又称为 JSbridge。

不同容器提供的 API Bridge 是不一样的，为某个容器写的网页，不能放在另一个容器内使用，也无法脱离容器，在浏览器里独立使用，除非网页脚本做了兼容处理，针对不同的容器调用不同的 API Bridge。

页面到底可以调用底层哪些 API ，取决于容器提供的 API Bridge。一旦平台更新，比如 iOS 发了新版本，有了新的 API，容器也必须跟着推出新版的 API Bridge。有时候，系统的 API 太新，容器没有跟上，开发者只能想办法自己来写 API Bridge。

![](https://www.wangbase.com/blogimg/asset/201912/bg2019120309.jpg)

### 4.3 混合 App 的优点

混合 App 的优点就是，同时具有原生 App 和 Web App的优点，又可以避免它们的一些缺点。开发者可以使用 Web 技术编写核心逻辑，外层的容器又可以使用原生 API 与底层系统交互。

具体来说，混合 App 有以下优点。

（1）Web 技术是跨平台的，所以开发者可以只写一次页面，就能支持多个平台。也就是说，混合 App 只需要一个团队就能支持多个平台，开发成本较低。同时，Web 页面的调试和构建比较容易，比原生 App 省时。

成本低还体现在人员成本。安卓和 iOS 平台的原生 App 开发者相对较少，招聘难度和成本都比较高，Web 的历史更长，技术更成熟，传统的前端程序员多，容易招到人。

（2）Web 技术为页面提供了很大的灵活性。一方面，可以方便地调用外部的 Web 服务，另一方面，混合 App 的 HTML、JavaScript、CSS 都是下载到容器里面，可以离线使用。

Web 页面的发布和更新都很简单，不必应用商店的批准，用户也不必重新安装整个应用。只要在远程服务器上发布新版本，在容器内触发更新机制即可。

（3）混合 App 的模式很适合大型 App 的插件结构，因为很容易让 App 加载外部的 H5 页面。大公司的 App 可以允许第三方开发者做好页面，加载到自己的 App 里面，因此可以吸引第三方开发者加入自己的平台。

### 4.4 混合 App 的缺点

混合 App 的主要缺点，上面已经提到了，主要是性能比较欠缺，不仅不如原生 App。由于 WebView 不是一个全功能的浏览器，性能甚至可能比 Web App 都要慢一些。

由于性能问题，手机游戏基本不能使用混合 App 开发，必须使用原生 App。

另一个缺点是，由于两个平台的页面代码是一样的，就无法使用某些只有特定平台提供的功能，导致体验不如纯的原生 App。举例来说，安卓有物理的后退按钮，iPhone 没有，页面设计时就很尴尬。

![](https://www.wangbase.com/blogimg/asset/201912/bg2019120310.jpg)

![](https://www.wangbase.com/blogimg/asset/201912/bg2019120311.jpg)

上面第一张是安卓，第二张图是 iOS。左上角的那个后退按钮，安卓系统其实是多余的。

此外，不同手机系统提供的浏览器控件是不一样的，可能导致 App 外观因平台而产生差异，比如滚动条、按钮等等。

### 4.5 小程序

2017年，微信正式推出了小程序，引发了潮流。国内大公司纷纷跟进，为自己 App 也引入了小程序能力。

所谓小程序，可以看作是 H5 开发的一种特殊情况。某个 App （比如微信）允许外部开发者编写的页面，在自己的容器内运行，调用容器的 API Bridge。同时，页面的开发语言必须使用容器规定的语言，使用指定工具进行编译和打包，防止出现不可控代码。

这样对于微信的好处是，扩大了自己的功能和应用场景，吸引外部开发者，繁荣了生态。对于外部开发者来说，可以借助微信的平台发展自己，有了流量入口，还能方便地调用微信内置的其他功能。因此，双方都能获益。

今天的介绍就到这里为止，希望大家已经理解了 H5 开发的相关概念。下一篇文章将介绍 H5 开发的各种工具和框架。

## 开发工具

### PhoneGap，Cordova，Ionic

PhoneGap（以前称为Apache Cordova），Ionic和Sencha等提供商的框架和工具就提供了本机包装器。它们通过WebView充当网页。

优点是容易开发，但是功能和性能都有限。

提供 API，调用本机接口。

```javascript
01.navigator.camera.getPicture (
02.    onCameraSuccess,
03.    onCameraError,
04.    {
05.        quality: 50,
06.        destinationType: Camera.DestinationType.DATA_URL
07.    }
08.);
09. 
10.function onCameraSuccess (imageData) {
11.    var image = document.getElementById('myImage');
12.    image.src = "data:image/jpeg;base64," + imageData;
13.}
14.  
15.function onCameraError (message) {
16.    alert('Failed because: ' + message);
17.}
```

与 ionic 类似的框架，还有 Framework 7。

### Xamarin

Xamarin是跨平台软件开发工具，用于在iOS和Android以及其他依赖C＃作为编程语言的平台上进行本机应用程序开发。

微软于2016年3月收购Xamarin。它可以让你在 Windows 平台开发 iOS 应用。

### React Native

这些工具仍使用Web技术。它们弥补了WebView的性能缺陷，并使脱机内容可访问。

在幕后，发生的是将每个工具中用JavaScript编写的调用映射到给定移动平台上与本机UI元素相对应的那些调用。

文本渲染在iOS上解释为[UIView]，在Android上解释为[TextView]。

除了 React Native，还有一个 NativeScript 项目，也是做类似的事情，把 JavaScript 编译成原生控件。不过，它的开发模型是基于 Angular.js。

## Xcode

[https://developer.apple.com/documentation/webkit/wkwebview](https://developer.apple.com/documentation/webkit/wkwebview)

App Store 进行安装 Xcode

1、新建一个项目
2、选择 ios -> single view app

名称 iOSWebViewTutorial

团队、组织名、组织识别符`com.[你的 ID]`、语言 Swift、语言 Swift、SwiftUI/StoryBoard、清除单元测试、UI 测试

选择储存位置

## Android Studio

[https://medium.com/@stevesohcot/andriod-studio-webview-tutorial-4651701d7d1a](https://medium.com/@stevesohcot/andriod-studio-webview-tutorial-4651701d7d1a)

[https://abhiandroid.com/ui/webview](https://abhiandroid.com/ui/webview)

```
import androidx.appcompat.app.AppCompatActivity;
```

## Ionic

部署

[https://ionicframework.com/docs/v3/intro/deploying/](https://ionicframework.com/docs/v3/intro/deploying/)

