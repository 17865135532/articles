# 权限

## 普通权限

文件有三种权限。

- r，读权限，用八进制的4或者二进制的100表示
- w，写权限，用八进制的2或者二进制的010表示
- x，执行权限，用八进制的1或者二进制的001表示

文件权限的含义。

- r：文件可以打开，读取内容。
- w：文件可以编辑和修改。是否可以改名和删除，由目录属性决定。
- x：文件可以被当作程序执行，前提是“读权限”必须也打开。

目录权限的含义。

- r：列出目录内容。
- w：允许目录内新建、删除、改名文件
- x：允许进入该目录（即`cd directory`），实质是获取目录内每个文件的详细信息

这三种权限可以有8种组合。

- `---` 二进制的000，八进制的0
- `--x` 二进制的001，八进制的1
- `-w-` 二进制的010，八进制的2
- `-wx` 二进制的011，八进制的3
- `r--` 二进制的100，八进制的4
- `r-x` 二进制的101，八进制的5
- `rw-` 二进制的110，八进制的6
- `rwx` 二进制的111，八进制的7

每个文件或者目录有三种使用对象。

- 文件的所有者
- 文件所在的组
- 其他用户

每种对象都有上面三种权限，因此通常用`rwxrwxrwx`这种形式，表示这三种使用对象的权限，写成八进制就是`777`。

## 特殊权限

Linux系统提供几个特殊权限。

setuid 位（八进制4000)。当应用到一个可执行文件时，它把有效用户 ID 从真正的用户（实际运行程序的用户）设置成程序所有者的 ID。这种操作通常会应用到 一些由超级用户所拥有的程序。当一个普通用户运行一个程序，这个程序由根用户(root) 所有，并且设置了 setuid 位，这个程序运行时具有超级用户的特权，这样程序就可以 访问普通用户禁止访问的文件和目录。很明显，因为这会引起安全方面的问题，所有可以 设置 setuid 位的程序个数，必须控制在绝对小的范围内。

setgid 位（八进制2000），这个相似于 setuid 位，把有效用户组 ID 从真正的用户组 ID 更改为文件所有者的组 ID。如果设置了一个目录的 setgid 位，则目录中新创建的文件具有这个目录用户组的所有权，而不是文件创建者所属用户组的所有权。

对于共享目录来说，用户A创建一个文件或目录，该文件的所有者和用户组，就是用户A，其他用户可能会无法编辑。这时，设置`setgid`位就很有用处，用户B处理这个文件时，系统自动把用户B放入该文件的用户组之中。

sticky 位（八进制1000）。这个继承于 Unix，在 Unix 中，它可能把一个可执行文件 标志为“不可交换的”。在 Linux 中，会忽略文件的 sticky 位，但是如果一个目录设置了 sticky 位， 那么它能阻止用户删除或重命名文件，除非用户是这个目录的所有者，或者是文件所有者，或是 超级用户。这个经常用来控制访问共享目录，比方说/tmp。

```bash
# 设置程序的setuid权限
$ chmod u+s program

# 设置目录的setgid权限
$ chmod g+s dir

# 设置目录的sticky权限
$ chmod +t dir
```

设置`setuid`属性的文件，权限显示为`-rwsr-xr-x`；设置`setgid`属性的目录，权限显示为`drwxrwsr-x`；设置`sticky`属性的目录，权限显示为`drwxrwxrwt`。
